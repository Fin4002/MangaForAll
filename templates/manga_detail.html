{% extends 'base.html' %}
{% block title %}{{ manga.Title }} · MangaForAll{% endblock %}
{% block content %}

<div class="hero" style="--hero: url('{{ url_for('static', filename=manga.CoverPath) if manga.CoverPath else url_for('static', filename='placeholder.jpg') }}')">
  <div class="hero-inner">
    <div class="cover-hero" style="background-image:url('{{ url_for('static', filename=manga.CoverPath) if manga.CoverPath else url_for('static', filename='placeholder.jpg') }}')"></div>
    <div>
      <h1 class="hero-title">{{ manga.Title }}</h1>
      <div class="hero-meta">
        <span class="card-sub">By {{ manga.Author_name or "Unknown" }}</span>
        <span class="badge {{ 'ok' if (manga.publication_status or '')|lower == 'ongoing' else 'warn' }}">
          {{ (manga.publication_status or 'Unknown')|capitalize }}
        </span>
      </div>

      {% if manga.synopsis %}
        <p class="synopsis">{{ manga.synopsis }}</p>
      {% endif %}

      <div class="hero-actions">
        {% if user %}
          <form method="post" action="{{ url_for('wishlist_toggle', manga_id=manga.manga_id) }}">
            {% if favorited %}
              <button class="btn outline" type="submit">★ Favorited — Remove</button>
            {% else %}
              <button class="btn" type="submit">☆ Add to Favorites</button>
            {% endif %}
          </form>
        {% else %}
          <a class="btn outline" href="{{ url_for('login', next=request.full_path) }}">Log in to favorite</a>
        {% endif %}
      </div>
    </div>
  </div>
</div>

<div class="space"></div>

<h2>Chapters</h2>
{% if chapters %}
  <table class="table chapters-table">
    <tbody>
      {% for ch in chapters %}
        <tr class="chapter-row"
            data-href="{{ url_for('reader', folder=folder, chapter=ch, back=request.full_path) }}"
            tabindex="0" role="link" aria-label="Open {{ ch }}">
          <td>
            <a class="chapter-link"
               href="{{ url_for('reader', folder=folder, chapter=ch, back=request.full_path) }}">
              {{ ch }}
            </a>
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
{% else %}
  <p>No chapters yet.</p>
{% endif %}


{% endblock %}
